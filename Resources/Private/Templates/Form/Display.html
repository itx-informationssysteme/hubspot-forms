<html
	xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
	xmlns:itx="http://typo3.org/ns/Itx/HubspotForms/ViewHelpers"
	data-namespace-typo3-fluid="true">
	<f:layout name="DefaultLayout" />

	<f:section name="Main">
		<f:flashMessages />
		<f:asset.script
			identifier="hubspot-forms-friendlycaptcha"
			src="EXT:hubspot_forms/Resources/Public/Scripts/friendlycaptcha.js"
			defer="1" />
		<f:if condition="{form}">
			<div>
				<h3 style="margin: 10px 10px">{form.name}</h3>
				<f:form
					name="form"
					action="submit"
					section="thank_you/{form.id}"
					class="hubspot-form"
					arguments="{message: form.configuration.postSubmitAction.value, formId: form.id}">
					<f:if condition="{fieldGroup.richText}">
						<f:then>
							<div style="margin: 0px 10px">
								<f:format.html>{fieldGroup.richText}</f:format.html>
							</div>
						</f:then>
						<f:else>
							<f:for each="{form.fieldGroups}" as="fieldGroup">
								<div style="display: flex; margin: 20px 0px">
									<f:if condition="{fieldGroup.richText}">
										<f:format.html>{fieldGroup.richText}</f:format.html>
									</f:if>

									<f:for each="{fieldGroup.fields}" as="field">
										<div style="margin: 0px 10px">
											<f:render partial="Switch" arguments="{field: field, form: form}" />
										</div>
									</f:for>
								</div>
							</f:for>
						</f:else>
					</f:if>
					<div style="margin: 0px 10px; max-width: 60%">
						<f:render
							partial="LegalConsentOptions"
							arguments="{legalConsentOptions: form.legalConsentOptions, id:
                form.id}" />
					</div>
					<f:variable
						name="send"
						value="{f:translate(key:
                'LLL:EXT:hubspot_forms/Resources/Private/Language/locallang.xlf:select.placeholder')}"></f:variable>
					<f:variable name="sitekey" value="{itx:friendlyCaptchaSitekey()}"> </f:variable>
					<f:if condition="{sitekey}">
						<div>
							<script
								type="module"
								src="https://cdn.jsdelivr.net/npm/friendly-challenge@0.9.12/widget.module.min.js"
								async
								defer></script>
							<script
								nomodule
								src="https://cdn.jsdelivr.net/npm/friendly-challenge@0.9.12/widget.min.js"
								async
								defer></script>
							<div
								class="frc-captcha"
								data-sitekey="<f:format.raw>{sitekey}</f:format.raw>"
								data-start="auto"></div>
						</div>
					</f:if>
					<button class="button button--filled" type="submit">
						{f:if(condition: form.displayOptions.submitButtonText, then: form.displayOptions.submitButtonText, else:
						send)}
					</button>
				</f:form>
			</div>
		</f:if>
	</f:section>
</html>
